import React, {useEffect,useContext, useState, Fragment} from 'react'

import Feed from "components/feed";
import useFetch from 'hooks/useFetch'

import {CurrentUserContext} from 'contexts/currentUser'



const GlobalFeed = () => {
 
const [currentUserState, setCurrentUserState] = useContext(CurrentUserContext)
const apiURL = '/articles?limit=10&offset=0'
const [{response,isLoading,error}, doFetch] = useFetch(apiURL)
const {isLogged,currentUser} = currentUserState // soburboris@ger.ru

useEffect(() => {
    doFetch()
},[doFetch])
   return (
    <React.Fragment>       
            {isLogged &&
             <div className='home-page'>
                 <div className='banner'>
                     <div className='container'>
                         <h1>Medium clone</h1>
                         <p>A place to share knowladge</p>
                     </div>
                 </div>
                 <div className='container page'>
                     <div className='row'>
                         <div className='col-md-9'>
                             {isLoading && <div>Loading...</div>}
                             {error && <div>Sometimes errors happend</div>}
                             {!isLoading && response && 
                             <Fragment>
                                    <Feed articles={response.articles} />
                            </Fragment>}
                         </div>
                         <div className='col-md-3'>
                             Popular tags
                         </div>
                     </div>
                 </div>
             </div>
                }

            {!isLogged && !isLoading &&
                <div className='container'>
                    <div className='col-md-6 modals'>
                    
                            <h2 >Вам необходимо зарегестрироваться!</h2>
                            
                    </div>
            </div>
            } 
        
         
 
         
    </React.Fragment>
       
)}
export default GlobalFeed