import React, {Fragment, useContext} from 'react'
import {Link} from 'react-router-dom'


import {CurrentUserContext} from 'contexts/currentUser'
import useLocalStorage from 'hooks/useLocalStorage'



 


const TopBar = () => {
    const [{isLogged,currentUserName,currentUser},dispatch] = useContext(CurrentUserContext)
    const [, setToken] = useLocalStorage('token')
  
    return (
        <nav className='navbar navbar-light'>
            <div className='container'>
                <Link to='/' className='navbar-brand'>
                    Medium
                </Link>
                <ul className='nav navbar-nav pull-xs-right'>
                    <li className='nav-item'>
                        <Link to='/' className='nav-link' >
                            Home
                        </Link>
                    </li>
                    {!isLogged && 
                    <Fragment>
                    <li className='nav-item'>
                        <Link to='/login' className='nav-link' >
                            Sign in
                        </Link>
                    </li>
                    <li className='nav-item'>
                        <Link to='/register' className='nav-link' >
                            Sign up
                        </Link>
                    </li>

                    </Fragment>}
                    {isLogged && 
                    <Fragment>
                    <li className='nav-item'>
                        <Link to='/articles/new' className='nav-link' >
                           <i className='ion-compose'></i>
                           &nbsp; New Post
                        </Link>
                    </li>
                    <li className='nav-item'>
                        <Link to='/settings' className='nav-link' >
                           <i className='ion-gear-a'></i>
                           &nbsp; Settings
                        </Link>
                    </li>
                    <li className='nav-item'>
                        <Link to={`/profiles/${currentUserName}`}
                        className='nav-link' >
                           <img 
                           className='user-pic'
                            src={currentUser.image}
                            alt=''
                           />
                           &nbsp; {currentUserName}
                        </Link>
                    </li>     
                   
                    <li className="nav-item">
                        <a className="nav-link" href="#" onClick={()=>{
                            dispatch({type: 'SET_UNAUTHORIZED'}) 
                            setToken('')                           
                            // localStorage.removeItem('token')
                        }

                        }>{`Выйти`}</a>
                    </li>
                        
                    

                    </Fragment>}
                   
                    
                                         


                </ul>
            </div>
        </nav>
    )

    
}


export default TopBar